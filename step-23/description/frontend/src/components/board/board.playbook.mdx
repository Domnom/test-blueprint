# board Component (Scene for a visual component)
Holds a bunch of CardList components

### What we are working on
We have a working board that can drag cards and card lists around but we haven't really tested if it works

VIEW ISSUE #36 (this has the refactored code)
We have chosen to refactor the code that exists at `Board.handleDragAndDropOnDragEnd` so that we can test it
as a unit (unit test)

The idea behind testing this unit is to ensure that we are receiving the correct data for rendering BUT that the data
that we are giving it is not mutated. This is a React rule, the rule that props and state should never mutate but be "read-only".

We also want to refactor this code so that our other components that require the `onDragEnd` to work WITHOUT the dependency of `Board` can
still run. This is necessary in the storybook as our card-lists currently do not save their card positions yet they work 

The code has now been shifted to another file at the path `src/services/react-beautiful-dnd/responders.service.ts` 

We will be using this new code to generate a new value which will set to the state.

Once we refactor the code, the `Board` no longer saves the positions of cardlists and cards. This is because our old code broke
the rules of React and we were actually modifying the this.props data and this.state data directly

We will also notice an interesting feature with `setState` that the misleading function `getDerivedStateFromProps` calls each time the state or props get set.
This function is required for when the props come through and require re-ordering BUT not required if the `setState` has been called with the correct order already 
set. We could argue that so far only this.props is set once and will never change so we could order in the constructor. This would let us set the state with data in the
correct order and be confident there is no double sorting going on.
However this does not work if this.props changes, which is what happens when we use storybook

**Storybook**
- useKnobs has the ability to modify the this.props of a component dyanmically
- Drag and drop continues to use the component functionality (as if it were a real app)

**App**
- No direct access to modifying the this.props (unless we build an app that specifically changes the `Board` prop values)
- State updates as per usual

Using storybook means we need to accomodate for dynamic prop changes so let's maintain the React function `getDerivedStateFromProps`
so we can order any changes from `this.props` BUT set a flag on `this.state`, called `runGetDerivedState` which will be set 
to `false` on any `this.setState` calls where we DO NOT want the `getDerivedStateFromProps` to run and instead return the same state but the 
flag is reset to `true` (set to `true` incase the property updates again). This is probably not best solution but we will give it a try 
and change it later if we want

Now our `Board` will be updating like before but using code that is refactored, tested and is following the rules
of React


## Steps 
### Wireframe/Design 
* Design 
*  

### Component 
#### Structure
The board should contain a name and a container that can hold a bunch of card lists

* Component
    * Board name
    * DragDropContext
        * Droppable
            * CardList container
                * Draggable
                    * <card-list.component.tsx\>
                * Draggable
                    * ...
                * Draggable
                    * <card-list.component.tsx\>


***

### Story 
We should have a single board component that has dynamic props which are editable using storybook knobs

The card lists should also be moveable and should only land within the card list container

***

### Unit Test
* We will add a proptypes unit test to the Board component
    * name
    * listsData

* The listsData prop should be an optional prop

* The lists data should be an array that contains an object with the following keys
    * id
    * position (generated by lexicographic util)
    * name
    * cards (array)
        * id
        * name

* Test what we should render when the listsData that is passed in is
    * Valid - Print the list to the screen
    * Invalid - Skip the list with invalid data
    * Mixed - Print valid and skip invalid
    

***

### BDD Test 
* When we load the Board to the screen,
We will see the board name and
We will see 2 card lists and
Each list will have 2 cards each

    Given I have a Board
    When I look at it
    Then I should see the name of the board
    And I should see 2 card lists with the names of 'List 1' and 'List 2'
    And 2 Cards on each list with the names of 'Card 1', 'Card 2', 'Card 3' and 'Card 4'
