import React from 'react';
import { checkProps } from '../../common/utils/test-helpers';
import { render, RenderResult } from '@testing-library/react';

import CardList from './card-list.component';

describe("CardListComponent", () => {

    describe("Checking prop types", () => {

        it ("Should not throw any warnings", () => {

            const expectedProps = {
                name : "card name",
                cardsData : [
                    {
{{partial_1}}                        name: "Card 1"
                    },
                    {
{{partial_2}}                        name : "Card 2"
                    }
                ]
            }

            const propErrors = checkProps(CardList, expectedProps);

            expect(propErrors).toBeUndefined();

        })

        it ("Should throw warnings when there are missing required properties", () => {

            const expectedProps = {};

            const propErrors = checkProps(CardList, expectedProps);

            expect(propErrors).toBeDefined();
        })

    })

    describe("Render", () =>{


        it ("Should render without errors with no cardData", () => {

            const renderedComponent: RenderResult = render(<CardList name="Card list"/>)

            const cardContainerDiv: HTMLElement = renderedComponent.getByTestId('cardList.cardContainer');

            expect(cardContainerDiv.childElementCount).toBe(0);
        })

        it ("Should render without errors with valid cardData", () => {

            const cardData: any = [
                {
{{partial_3}}                    name : "Card 1"
                },
                {
{{partial_4}}                    name : "Card 2"
                }
            ]
            const renderedComponent: RenderResult = render(<CardList name="Card list" cardsData={cardData} />)

            const card1Div = renderedComponent.getByText(cardData[0].name);
            const card2Div = renderedComponent.getByText(cardData[1].name);

            // expect(card1Div).toBeDefined();
            // expect(card2Div).toBeDefined();

        })

        it ("Should render without errors with invalid cardData", () => {

            const cardData: any = [
                {
                    invalidKey : "Card 1"
                },
                {
                    randomProperty : "Card 2"
                }
            ]
            const renderedComponent: RenderResult = render(<CardList name="Card list" cardsData={cardData} />)

            const card1Div = renderedComponent.queryByText(cardData[0].invalidKey);
            const card2Div = renderedComponent.queryByText(cardData[1].randomProperty);

            expect(card1Div).toBeNull();
            expect(card2Div).toBeNull();
        })

        it ("Should render without errors with half invalid and half valid cardData", () => {

            const cardData: any = [
                {
{{partial_5}}                },
                {
{{partial_6}}                    name : "Card 2"
                }
            ]

            const renderedComponent: RenderResult = render(<CardList name="Card list" cardsData={cardData} />)

{{partial_7}}            const card2Div = renderedComponent.getByText(cardData[1].name);

            expect(card1Div).toBeNull();
        })
    });

})